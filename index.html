<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Love Journey">
    <meta name="theme-color" content="#0a0a1a">
    <title>๐ Love Journey - Hรnh Trรฌnh Tรฌnh Yรชu</title>
    <meta name="description" content="Trรฒ chฦกi bรn cแป tรฌnh yรชu - Hai ngฦฐแปi lang thang rแปi lแบกi gแบทp nhau">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- iOS Icons -->
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-180.png">
    <link rel="apple-touch-icon" sizes="167x167" href="icons/icon-167.png">
    <link rel="apple-touch-icon" sizes="152x152" href="icons/icon-152.png">
    <link rel="apple-touch-icon" sizes="120x120" href="icons/icon-120.png">

    <!-- iOS Splash Screens for iPhone 11 (828x1792) -->
    <link rel="apple-touch-startup-image" href="icons/splash-828x1792.png"
        media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2)">

    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&family=Pacifico&display=swap"
        rel="stylesheet">
</head>

<body>
    <!-- Offline indicator -->
    <div id="offline-indicator" class="offline-indicator hidden">๐ต ฤang offline</div>

    <!-- Setup Screen -->
    <div id="setup-screen" class="screen active">
        <div class="setup-container">
            <h1 class="game-title">๐ Love Journey ๐</h1>
            <p class="subtitle">Hai ngฦฐแปi lang thang giแปฏa dรฒng ฤแปi... rแปi lแบกi gแบทp nhau</p>

            <div class="player-inputs">
                <div class="player-input p1-input">
                    <label for="player1-name">๐ Ngฦฐแปi แบฅy</label>
                    <input type="text" id="player1-name" placeholder="Nhแบญp tรชn..." maxlength="10">
                </div>
                <div class="heart-divider">๐</div>
                <div class="player-input p2-input">
                    <label for="player2-name">๐ Ngฦฐแปi nรy</label>
                    <input type="text" id="player2-name" placeholder="Nhแบญp tรชn..." maxlength="10">
                </div>
            </div>

            <button id="start-game-btn" class="btn-primary">
                <span>Bแบฏt ฤแบงu Hรnh Trรฌnh</span>
                <span class="btn-icon">๐</span>
            </button>

            <div class="game-rules">
                <h3>๐ฒ Luแบญt Chฦกi</h3>
                <ul>
                    <li>๐ฒ Tung xรบc xแบฏc ฤแป di chuyแปn (1-6 bฦฐแปc)</li>
                    <li>๐ฌ Hoรn thรnh nhiแปm vแปฅ tแบกi mแปi รด</li>
                    <li>๐ Gแบทp nhau tแบกi <strong>ฤiแปm Hแบนn</strong> = Hoแบกt ฤแปng cแบทp ฤรดi!</li>
                    <li>๐ฏ Roll ฤรบng sแป ฤแป vแป ฤรญch</li>
                    <li>๐ Ai vแป ฤรญch trฦฐแปc thรฌ thแบฏng!</li>
                </ul>
            </div>

            <!-- Audio Settings -->
            <div class="audio-settings">
                <h3>๐ Cรi ฤแบทt รm Thanh</h3>
                <div class="audio-control">
                    <label for="sfx-volume">๐ต Hiแปu แปฉng รขm thanh</label>
                    <div class="slider-container">
                        <input type="range" id="sfx-volume" min="0" max="100" value="70" class="volume-slider">
                        <span id="sfx-value" class="volume-value">70%</span>
                    </div>
                </div>
                <div class="audio-control">
                    <label for="music-volume">๐ถ Nhแบกc nแปn</label>
                    <div class="slider-container">
                        <input type="range" id="music-volume" min="0" max="100" value="50" class="volume-slider">
                        <span id="music-value" class="volume-value">50%</span>
                    </div>
                </div>
                <div class="audio-toggle">
                    <label class="toggle-label">
                        <input type="checkbox" id="music-toggle" checked>
                        <span class="toggle-slider"></span>
                        <span class="toggle-text">Bแบญt nhแบกc nแปn</span>
                    </label>
                </div>
            </div>

        </div>
    </div>

    <!-- Game Screen -->
    <div id="game-screen" class="screen">
        <!-- Menu Button - Fixed at screen corner -->
        <button id="back-to-menu-btn" class="btn-back" title="Quay vแป menu">
            โฌ๏ธ Menu
        </button>

        <!-- Player Status Bar -->
        <div class="status-bar">
            <div class="player-card p1-card">
                <div class="player-avatar-wrapper">
                    <span class="player-avatar">๐</span>
                    <span class="player-piece p1-piece"></span>
                </div>
                <div class="player-info-text">
                    <span class="player-name" id="p1-display-name">Anh</span>
                    <span class="player-stats">
                        <span id="p1-position">ร 0/20</span>
                        <span id="p1-penalty" class="penalty-badge">โก 0</span>
                    </span>
                </div>
            </div>

            <div class="turn-display">
                <span class="turn-label">Lฦฐแปฃt cแปงa</span>
                <span id="current-player-name" class="current-player">Anh</span>
            </div>

            <div class="player-card p2-card">
                <div class="player-avatar-wrapper">
                    <span class="player-avatar">๐</span>
                    <span class="player-piece p2-piece"></span>
                </div>
                <div class="player-info-text">
                    <span class="player-name" id="p2-display-name">Em</span>
                    <span class="player-stats">
                        <span id="p2-position">ร 0/20</span>
                        <span id="p2-penalty" class="penalty-badge">โก 0</span>
                    </span>
                </div>
            </div>
        </div>

        <!-- Game Board Canvas - EXPANDED -->
        <div class="board-container">
            <div class="board-scroll-wrapper">
                <div class="board-inner">
                    <div class="board-background">
                        <!-- Corner decorations (far from lanes) -->
                        <div class="decoration tree" style="top: 3%; left: 1%;">๐ณ</div>
                        <div class="decoration tree" style="top: 3%; right: 1%;">๐ณ</div>
                        <div class="decoration tree" style="bottom: 3%; left: 1%;">๐ฒ</div>
                        <div class="decoration tree" style="bottom: 3%; right: 1%;">๐ฒ</div>

                        <!-- Top edge decorations -->
                        <div class="decoration" style="top: 2%; left: 20%;">โญ</div>
                        <div class="decoration" style="top: 2%; left: 40%;">๐</div>
                        <div class="decoration" style="top: 2%; right: 40%;">โจ</div>
                        <div class="decoration" style="top: 2%; right: 20%;">๐</div>

                        <!-- Bottom edge decorations -->
                        <div class="decoration" style="bottom: 2%; left: 25%;">๐ท</div>
                        <div class="decoration" style="bottom: 2%; left: 45%;">๐ป</div>
                        <div class="decoration" style="bottom: 2%; right: 45%;">๐บ</div>
                        <div class="decoration" style="bottom: 2%; right: 25%;">๐ธ</div>

                        <!-- Left edge decorations -->
                        <div class="decoration" style="top: 35%; left: 0.5%;">๐ฆ</div>
                        <div class="decoration" style="top: 65%; left: 0.5%;">๐ฆ</div>

                        <!-- Right edge decorations -->
                        <div class="decoration" style="top: 35%; right: 0.5%;">๐ฆข</div>
                        <div class="decoration" style="top: 65%; right: 0.5%;">๐ฆ</div>

                        <!-- Corner accent icons -->
                        <div class="decoration" style="top: 8%; left: 5%;">๐</div>
                        <div class="decoration" style="top: 8%; right: 5%;">๐</div>
                        <div class="decoration" style="bottom: 8%; left: 5%;">๐</div>
                        <div class="decoration" style="bottom: 8%; right: 5%;">๐ผ</div>

                        <!-- Far corner decorations -->
                        <div class="decoration heart-deco" style="top: 5%; left: 12%;">๐</div>
                        <div class="decoration heart-deco" style="top: 5%; right: 12%;">๐</div>
                        <div class="decoration" style="bottom: 5%; left: 12%;">๐</div>
                        <div class="decoration" style="bottom: 5%; right: 12%;">๐ก</div>
                    </div>

                    <!-- SVG Board - EXPANDED LAYOUT -->
                    <svg class="board-svg" viewBox="0 0 4000 1000" preserveAspectRatio="xMidYMid meet">
                        <defs>
                            <linearGradient id="path1Gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#667eea;stop-opacity:0.35" />
                                <stop offset="100%" style="stop-color:#764ba2;stop-opacity:0.35" />
                            </linearGradient>
                            <linearGradient id="path2Gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#ff6b9d;stop-opacity:0.35" />
                                <stop offset="100%" style="stop-color:#c44cff;stop-opacity:0.35" />
                            </linearGradient>
                            <filter id="glow">
                                <feGaussianBlur stdDeviation="6" result="coloredBlur" />
                                <feMerge>
                                    <feMergeNode in="coloredBlur" />
                                    <feMergeNode in="SourceGraphic" />
                                </feMerge>
                            </filter>
                        </defs>

                        <!-- Lane 1 Track (Blue) - EXPANDED PATH -->
                        <path id="lane1-track" d="M 150,850 
                                 Q 500,850 900,500 
                                 Q 1300,150 1800,500 
                                 Q 2300,850 2700,500 
                                 Q 3100,150 3600,150" fill="none" stroke="url(#path1Gradient)" stroke-width="140"
                            stroke-linecap="round" />

                        <!-- Lane 2 Track (Pink) - EXPANDED PATH -->
                        <path id="lane2-track" d="M 150,150 
                                 Q 500,150 900,500 
                                 Q 1300,850 1800,500 
                                 Q 2300,150 2700,500 
                                 Q 3100,850 3600,850" fill="none" stroke="url(#path2Gradient)" stroke-width="140"
                            stroke-linecap="round" />

                        <!-- Lane 1 Path Line (Blue) -->
                        <path id="lane1-path" d="M 150,850 
                                 Q 500,850 900,500 
                                 Q 1300,150 1800,500 
                                 Q 2300,850 2700,500 
                                 Q 3100,150 3600,150" fill="none" stroke="#667eea" stroke-width="4"
                            stroke-dasharray="12,6" opacity="0.9" />

                        <!-- Lane 2 Path Line (Pink) -->
                        <path id="lane2-path" d="M 150,150 
                                 Q 500,150 900,500 
                                 Q 1300,850 1800,500 
                                 Q 2300,150 2700,500 
                                 Q 3100,850 3600,850" fill="none" stroke="#ff6b9d" stroke-width="4"
                            stroke-dasharray="12,6" opacity="0.9" />

                        <!-- Intersection Highlights -->
                        <circle cx="900" cy="500" r="80" fill="rgba(0,217,255,0.25)" filter="url(#glow)"
                            class="intersection-glow" />
                        <circle cx="1800" cy="500" r="80" fill="rgba(0,217,255,0.25)" filter="url(#glow)"
                            class="intersection-glow" />
                        <circle cx="2700" cy="500" r="80" fill="rgba(0,217,255,0.25)" filter="url(#glow)"
                            class="intersection-glow" />

                        <!-- Tiles Layer -->
                        <g id="tiles-layer"></g>

                        <!-- Players Layer -->
                        <g id="players-layer"></g>
                    </svg>

                    <!-- Labels -->
                    <div class="board-label start-label-p1">
                        <span>๐ START</span>
                        <span class="label-player">๐</span>
                    </div>
                    <div class="board-label start-label-p2">
                        <span>๐ START</span>
                        <span class="label-player">๐</span>
                    </div>
                    <div class="board-label finish-label-p1">
                        <span>๐ FINISH</span>
                        <span class="label-player">๐</span>
                    </div>
                    <div class="board-label finish-label-p2">
                        <span>๐ FINISH</span>
                        <span class="label-player">๐</span>
                    </div>

                    <!-- Intersection Labels - BELOW intersection points -->
                    <div class="intersection-label" style="left: 20%; top: 70%;">๐ Hแบนn 1</div>
                    <div class="intersection-label" style="left: 42.5%; top: 70%;">๐ Hแบนn 2</div>
                    <div class="intersection-label" style="left: 65%; top: 70%;">๐ Hแบนn 3</div>
                </div>
            </div>
        </div>

        <!-- Dice & Controls -->
        <div class="controls-section">
            <div class="dice-area">
                <div class="dice-3d" id="dice">
                    <div class="dice-face front"><span class="dot"></span></div>
                    <div class="dice-face back"><span class="dot"></span><span class="dot"></span><span
                            class="dot"></span><span class="dot"></span><span class="dot"></span><span
                            class="dot"></span></div>
                    <div class="dice-face right"><span class="dot"></span><span class="dot"></span><span
                            class="dot"></span></div>
                    <div class="dice-face left"><span class="dot"></span><span class="dot"></span><span
                            class="dot"></span><span class="dot"></span></div>
                    <div class="dice-face top"><span class="dot"></span><span class="dot"></span></div>
                    <div class="dice-face bottom"><span class="dot"></span><span class="dot"></span><span
                            class="dot"></span><span class="dot"></span><span class="dot"></span></div>
                </div>
            </div>
            <button id="roll-dice-btn" class="btn-roll">
                ๐ฒ Tung Xรบc Xแบฏc
            </button>
            <div class="dice-result" id="dice-result"></div>
        </div>

        <!-- Legend -->
        <div class="legend-bar">
            <span class="legend-item"><span class="legend-dot romance"></span>Lรฃng mแบกn</span>
            <span class="legend-item"><span class="legend-dot deep"></span>Sรขu sแบฏc</span>
            <span class="legend-item"><span class="legend-dot fun"></span>Vui nhแปn</span>
            <span class="legend-item"><span class="legend-dot intimate"></span>Thรขn mแบญt</span>
            <span class="legend-item"><span class="legend-dot dare"></span>Thแปญ thรกch</span>
            <span class="legend-item"><span class="legend-dot overlap"></span>ฤiแปm hแบนn</span>
        </div>
    </div>

    <!-- Modals -->
    <div id="question-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header" id="modal-header">
                <span class="modal-icon" id="modal-icon">๐</span>
                <span class="modal-category" id="modal-category">Lรฃng Mแบกn</span>
            </div>
            <div class="modal-body">
                <p class="question-text" id="question-text">Cรขu hแปi...</p>
                <div class="timer-bar">
                    <div class="timer-progress" id="timer-progress"></div>
                </div>
                <span class="timer-text" id="timer-text">60s</span>
            </div>
            <div class="modal-footer">
                <button id="complete-task-btn" class="btn-complete">โ Hoรn Thรnh</button>
            </div>
        </div>
    </div>

    <div id="special-modal" class="modal">
        <div class="modal-content special-content">
            <div class="special-icon" id="special-icon">โญ</div>
            <h2 class="special-title" id="special-title">ร ฤแบทc Biแปt!</h2>
            <p class="special-desc" id="special-desc">...</p>
            <button id="special-ok-btn" class="btn-primary">OK</button>
        </div>
    </div>

    <div id="overlap-modal" class="modal">
        <div class="modal-content overlap-content">
            <div class="overlap-icon">๐</div>
            <h2 class="overlap-title" id="overlap-title">ฤiแปm Hแบนn Tรฌnh Yรชu!</h2>
            <p class="overlap-desc" id="overlap-desc">ฤang chแป...</p>
            <button id="overlap-ok-btn" class="btn-primary">ฤรฃ hiแปu!</button>
        </div>
    </div>

    <!-- Wait or Continue Modal - First player at meeting point -->
    <div id="wait-continue-modal" class="modal">
        <div class="modal-content choice-content">
            <div class="choice-icon">๐</div>
            <h2 class="choice-title" id="wait-continue-title">ฤiแปm Hแบนn!</h2>
            <p class="choice-desc" id="wait-continue-desc">Bแบกn ฤรฃ ฤแบฟn ฤiแปm hแบนn. Chแป ฤแปฃi ngฦฐแปi แบฅy hay tiแบฟp tแปฅc?</p>
            <div class="choice-buttons">
                <button id="wait-btn" class="btn-accept">๐ Chแป ฤแปฃi (3 lฦฐแปฃt)</button>
                <button id="continue-btn" class="btn-refuse">โก Tiแบฟp Tแปฅc</button>
            </div>
            <p style="font-size: 0.8rem; color: #ff6b9d; margin-top: 0.5rem;">โ๏ธ Tiแบฟp tแปฅc = +1 โก (โฅ2 sแบฝ bแป phแบกt!)</p>
        </div>
    </div>

    <!-- Lightning Punishment Modal -->
    <div id="lightning-modal" class="modal">
        <div class="modal-content punishment-content">
            <div class="punishment-icon">โกโก</div>
            <h2 class="punishment-title" id="lightning-title">Sรฉt ฤรกnh!</h2>
            <p class="punishment-desc" id="lightning-desc">Bแบกn ฤรฃ tรญch ฤแปง 2 sรฉt! ฤแปi phฦฐฦกng ฤฦฐแปฃc quyแปn phแบกt bแบกn!</p>
            <p style="font-size: 0.9rem; color: #f7b731;">Chแปn 1 trong 2:</p>
            <div class="choice-buttons">
                <button id="lightning-action-btn" class="btn-refuse">๐ฅ Lรm thแปญ thรกch</button>
                <button id="lightning-question-btn" class="btn-accept">๐ฌ Trแบฃ lแปi cรขu hแปi</button>
            </div>
        </div>
    </div>

    <div id="couple-modal" class="modal">
        <div class="modal-content couple-content">
            <div class="couple-icon">๐โจ</div>
            <h2 class="couple-title" id="couple-title">Hoแบกt ฤแปng Cแบทp ฤรดi!</h2>
            <p class="couple-desc" id="couple-desc">...</p>
            <p class="couple-duration" id="couple-duration">โฑ๏ธ 60 giรขy</p>
            <button id="couple-complete-btn" class="btn-complete">๐ Hoรn Thรnh!</button>
        </div>
    </div>

    <div id="dual-meeting-modal" class="modal">
        <div class="modal-content couple-content">
            <div class="couple-icon">๐๐ฅ๐</div>
            <h2 class="couple-title" id="dual-meeting-title">Cแบฃ Hai ฤแปu แป ฤiแปm Hแบนn!</h2>
            <p class="couple-desc" id="dual-meeting-desc">Mแปi ngฦฐแปi phแบฃi hoรn thรnh 2 hoแบกt ฤแปng!</p>
            <div id="dual-meeting-activities">
                <p class="dual-activity" id="dual-activity-1">๐ธ Hoแบกt ฤแปng 1: ...</p>
                <p class="dual-activity" id="dual-activity-2">๐ธ Hoแบกt ฤแปng 2: ...</p>
            </div>
            <button id="dual-meeting-complete-btn" class="btn-complete">๐ Cแบฃ Hai Hoรn Thรnh!</button>
        </div>
    </div>

    <div id="choice-modal" class="modal">
        <div class="modal-content choice-content">
            <div class="choice-icon">๐ค</div>
            <h2 class="choice-title" id="choice-title">Lแปฑa Chแปn!</h2>
            <p class="choice-desc" id="choice-desc">...</p>
            <div class="choice-buttons">
                <button id="choice-accept-btn" class="btn-accept">๐ ฤแปng ร</button>
                <button id="choice-refuse-btn" class="btn-refuse">โ Tแปซ Chแปi</button>
            </div>
        </div>
    </div>

    <div id="punishment-modal" class="modal">
        <div class="modal-content punishment-content">
            <div class="punishment-icon">โ๏ธ</div>
            <h2 class="punishment-title" id="punishment-title">Hรฌnh Phแบกt!</h2>
            <p class="punishment-desc" id="punishment-desc">...</p>
            <p class="punishment-count" id="punishment-count">1/3</p>
            <button id="punishment-ok-btn" class="btn-primary">ฤรฃ Lรm!</button>
        </div>
    </div>

    <div id="revenge-modal" class="modal">
        <div class="modal-content revenge-content">
            <div class="revenge-icon">๐ฅ</div>
            <h2 class="revenge-title" id="revenge-title">PHแบขN ฤรN!</h2>
            <p class="revenge-desc" id="revenge-desc">...</p>
            <button id="revenge-ok-btn" class="btn-revenge">๐ Thแปฑc Hiแปn!</button>
        </div>
    </div>

    <div id="win-modal" class="modal">
        <div class="modal-content win-content">
            <div class="confetti-container" id="confetti"></div>
            <div class="trophy">๐</div>
            <h1 class="win-title">Chรบc Mแปซng!</h1>
            <p class="winner-name" id="winner-name">Player</p>
            <p class="win-message">ฤรฃ hoรn thรnh hรnh trรฌnh! ๐</p>
            <p class="win-subtitle">Nhฦฐng trong tรฌnh yรชu, cแบฃ hai ฤแปu chiแบฟn thแบฏng! ๐</p>
            <button id="play-again-btn" class="btn-primary">๐ Chฦกi Lแบกi</button>
        </div>
    </div>

    <script src="js/questions.js"></script>
    <script src="js/dice.js"></script>
    <script src="js/board.js?v=FIX_OVERLAP_3"></script>
    <script src="js/game.js?v=FIX_OVERLAP_3"></script>
    <script src="js/pwa.js"></script>
</body>

</html>